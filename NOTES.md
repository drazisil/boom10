It should be noted that there is a small mistake in Ben's example. He uses 00 04 82 24 25 c7 80 7f as example, which should decompress to AIAIAIAIAIAIA. However, testing this with my implementation failed. When I created it with the official pkware ziptool (see tests in pwexplode), the sequence turned out to be actually 00 04 82 24 25 8f 80 7f (notice the difference at byte 6). This will successfully decompress to AIAIAIAIAIAIA.